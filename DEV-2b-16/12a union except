# üìò `UNION`, `EXCEPT` –∏ –≤–∏–¥—ã `JOIN` –≤ PostgreSQL 16

---

## üß† –û—Å–Ω–æ–≤–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ

| –û–ø–µ—Ä–∞—Ü–∏—è | –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å—Ç—Ä–æ–∫–∏? | –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é –∑–Ω–∞—á–µ–Ω–∏–π? | –°–æ–µ–¥–∏–Ω—è–µ—Ç —Å—Ç–æ–ª–±—Ü—ã? |
| -------- | ------------------ | -------------------------------- | ------------------ |
| `JOIN`   | ‚ûñ –ù–µ—Ç              | ‚úÖ –î–∞ (–ø–æ —É—Å–ª–æ–≤–∏—é)                | ‚úÖ –î–∞               |
| `UNION`  | ‚úÖ –î–∞               | ‚ûñ –ù–µ—Ç (–ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ)             | ‚ûñ –ù–µ—Ç              |
| `EXCEPT` | ‚úÖ –î–∞               | ‚ûñ –ù–µ—Ç (–ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ)             | ‚ûñ –ù–µ—Ç              |

---

## üîπ –¢–∞–±–ª–∏—Ü—ã –¥–ª—è –ø—Ä–∏–º–µ—Ä–æ–≤

```sql
CREATE TABLE students (
    id int,
    name text
);

CREATE TABLE graduates (
    id int,
    name text
);
```

```sql
INSERT INTO students VALUES
(1, '–ò–≤–∞–Ω'),
(2, '–ú–∞—Ä–∏—è'),
(3, '–ü–µ—Ç—Ä');

INSERT INTO graduates VALUES
(2, '–ú–∞—Ä–∏—è'),
(4, '–°–µ—Ä–≥–µ–π');
```

---

## üî∏ 1. `UNION` ‚Äî –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫

```sql
SELECT name FROM students
UNION
SELECT name FROM graduates;
```

üß† –£–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã.

```sql
SELECT name FROM students
UNION ALL
SELECT name FROM graduates;
```

üîÅ –ü–æ–∫–∞–∂–µ—Ç –≤—Å–µ —Å—Ç—Ä–æ–∫–∏, –≤–∫–ª—é—á–∞—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è.

üìå –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ: –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ —á–∏—Å–ª–æ –∏ —Ç–∏–ø—ã —Å—Ç–æ–ª–±—Ü–æ–≤.

---

## üî∏ 2. `EXCEPT` ‚Äî —Ä–∞–∑–Ω–æ—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤

```sql
SELECT name FROM students
EXCEPT
SELECT name FROM graduates;
```

üìå –ü–æ–∫–∞–∂–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, **–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –≤—ã–ø—É—Å–∫–Ω–∏–∫–∞–º–∏**.

```text
name  
-------
–ò–≤–∞–Ω
–ü–µ—Ç—Ä
```

---

## üî∏ 3. `JOIN` ‚Äî –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ø–æ –∫–ª—é—á–∞–º

---

### ‚úÖ `INNER JOIN` ‚Äî –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ

```sql
SELECT *
FROM students s
INNER JOIN graduates g ON s.id = g.id;
```

üîç –¢–æ–ª—å–∫–æ —Ç–µ, –∫—Ç–æ –µ—Å—Ç—å –∏ –≤ `students`, –∏ –≤ `graduates`.

---

### ‚úÖ `LEFT JOIN` ‚Äî –≤—Å–µ –∏–∑ –ª–µ–≤–æ–π, + —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏–∑ –ø—Ä–∞–≤–æ–π

```sql
SELECT *
FROM students s
LEFT JOIN graduates g ON s.id = g.id;
```

üìå –ü–æ–∫–∞–∂–µ—Ç –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –≤–∫–ª—é—á–∞—è —Ç–µ—Ö, –∫—Ç–æ –Ω–µ –≤—ã–ø—É—Å–∫–Ω–∏–∫ (NULL –≤ `g.name`).

---

### ‚úÖ `CROSS JOIN` ‚Äî –¥–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ

```sql
SELECT s.name, g.name
FROM students s
CROSS JOIN graduates g;
```

üìà –ö–∞–∂–¥–æ–º—É —Å—Ç—É–¥–µ–Ω—Ç—É ‚Äî –≤—Å–µ –≤—ã–ø—É—Å–∫–Ω–∏–∫–∏ (–º–Ω–æ–≥–æ —Å—Ç—Ä–æ–∫).

---

### ‚úÖ `NATURAL JOIN` ‚Äî –ø–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º –∏–º–µ–Ω–∞–º —Å—Ç–æ–ª–±—Ü–æ–≤

```sql
SELECT *
FROM students
NATURAL JOIN graduates;
```

‚ö†Ô∏è –û—Å—Ç–æ—Ä–æ–∂–Ω–æ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–µ–¥–∏–Ω—è–µ—Ç –ø–æ **–≤—Å–µ–º —Å—Ç–æ–ª–±—Ü–∞–º —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∏–º–µ–Ω–∞–º–∏**. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –±–æ–ª—å—à–∏—Ö —Å—Ö–µ–º–∞—Ö –±–µ–∑ —Ç–æ—á–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è.

---

## üìå –ö—Ä–∞—Ç–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –û–ø–µ—Ä–∞—Ç–æ—Ä       | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                                       | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ                        |
| -------------- | ------------------------------------------------ | --------------------------------- |
| `UNION`        | –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π                 | –°–æ–≤–º–µ—â–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤               |
| `UNION ALL`    | –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å—Ç—Ä–æ–∫–∏ —Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏                 | –ë—ã—Å—Ç—Ä–µ–µ, –µ—Å–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã –Ω—É–∂–Ω—ã     |
| `EXCEPT`       | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤–æ –≤—Ç–æ—Ä–æ–π –≤—ã–±–æ—Ä–∫–µ | –í—ã—á–∏—Ç–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤                |
| `INNER JOIN`   | –°–æ–≤–ø–∞–≤—à–∏–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ —É—Å–ª–æ–≤–∏—é                      | –¢–æ–ª—å–∫–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ –∫–ª—é—á–∏          |
| `LEFT JOIN`    | –í—Å–µ –∏–∑ –ª–µ–≤–æ–π, + —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏–∑ –ø—Ä–∞–≤–æ–π             | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç "–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ" –¥–∞–Ω–Ω—ã–µ  |
| `CROSS JOIN`   | –í—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏                                   | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä, —Ç–µ—Å—Ç–æ–≤, –∫–æ–º–±–∏–Ω–∞—Ü–∏–π |
| `NATURAL JOIN` | –°–æ–µ–¥–∏–Ω—è–µ—Ç –ø–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º –∏–º–µ–Ω–∞–º —Å—Ç–æ–ª–±—Ü–æ–≤         | –ë—ã—Å—Ç—Ä–æ, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º |

---

## üß™ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ

1. –ù–∞–π–¥–∏ –∏–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å **–∏ —É —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∏ —É –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤** (`INTERSECT` —Ç–æ–∂–µ –º–æ–∂–Ω–æ).
2. –í—ã–≤–µ–¥–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã—Ö **–Ω–µ—Ç —Å—Ä–µ–¥–∏ –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤**.
3. –°–æ–µ–¥–∏–Ω–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤ –ø–æ `id` —Å `LEFT JOIN`, –ø–æ–∫–∞–∂–∏, –∫—Ç–æ –Ω–µ –≤—ã–ø—É—Å—Ç–∏–ª—Å—è.
4. –ü–æ—Å—Ç—Ä–æ–π —Ç–∞–±–ª–∏—Ü—É –≤—Å–µ—Ö –ø–∞—Ä —Å—Ç—É–¥–µ–Ω—Ç-–≤—ã–ø—É—Å–∫–Ω–∏–∫ (`CROSS JOIN`).


---

## üìç –í—ã–≤–æ–¥

* `JOIN` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **—Å–≤—è–∑–∏ —Ç–∞–±–ª–∏—Ü**
* `UNION`/`EXCEPT` ‚Äî –¥–ª—è **—Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤**
* –£–±–µ–¥–∏—Å—å, —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å: `JOIN` —Å–æ–µ–¥–∏–Ω—è–µ—Ç **–ø–æ –∫–ª—é—á–∞–º**, `UNION` —Ä–∞–±–æ—Ç–∞–µ—Ç **–ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ**



**—Ä–µ—à–µ–Ω–∏—è –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è** 

---


---

## üìò 1. –ù–∞–π–¥–∏ –∏–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å **–∏ —É —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∏ —É –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤**

### üîπ –í–∞—Ä–∏–∞–Ω—Ç 1: `INTERSECT`

```sql
SELECT name FROM students
INTERSECT
SELECT name FROM graduates;
```

### üîπ –í–∞—Ä–∏–∞–Ω—Ç 2: `INNER JOIN`

```sql
SELECT s.name
FROM students s
INNER JOIN graduates g ON s.name = g.name;
```

### üìå –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:

–û–±–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞—Ö–æ–¥—è—Ç **–∏–º–µ–Ω–∞, –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö**. –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ:

```
–ú–∞—Ä–∏—è
```

---

## üìò 2. –í—ã–≤–µ–¥–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã—Ö **–Ω–µ—Ç —Å—Ä–µ–¥–∏ –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤**

### üîπ –ò—Å–ø–æ–ª—å–∑—É–µ–º `EXCEPT`

```sql
SELECT name FROM students
EXCEPT
SELECT name FROM graduates;
```

### üìå –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:

–ù–∞—Ö–æ–¥–∏—Ç –∏–º–µ–Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã—Ö **–Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤**. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ:

```
–ò–≤–∞–Ω
–ü–µ—Ç—Ä
```

> ‚ö†Ô∏è –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–¥—ë—Ç **–ø–æ –∏–º–µ–Ω–∏**, –Ω–µ –ø–æ `id`. –ï—Å–ª–∏ –≤–∞–∂–µ–Ω `id`, –ø–µ—Ä–µ–ø–∏—à–∏ –∑–∞–ø—Ä–æ—Å –ø–æ `id`.

---

## üìò 3. –°–æ–µ–¥–∏–Ω–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤ –ø–æ `id` —Å `LEFT JOIN`, –ø–æ–∫–∞–∂–∏, –∫—Ç–æ –Ω–µ –≤—ã–ø—É—Å—Ç–∏–ª—Å—è

```sql
SELECT s.id, s.name AS student_name, g.name AS graduate_name
FROM students s
LEFT JOIN graduates g ON s.id = g.id
WHERE g.id IS NULL;
```

### üìå –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:

* `LEFT JOIN` –±–µ—Ä—ë—Ç –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
* `g.id IS NULL` –æ—Ç–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, **–∫—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤**
* –¢–æ –µ—Å—Ç—å ‚Äî **–Ω–µ –≤—ã–ø—É—Å–∫–Ω–∏–∫–∏**

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
id | student_name | graduate_name
----+--------------+---------------
 1 | –ò–≤–∞–Ω         | NULL
 3 | –ü–µ—Ç—Ä         | NULL
```

---

## üìò 4. –ü–æ—Å—Ç—Ä–æ–π —Ç–∞–±–ª–∏—Ü—É –≤—Å–µ—Ö –ø–∞—Ä —Å—Ç—É–¥–µ–Ω—Ç-–≤—ã–ø—É—Å–∫–Ω–∏–∫ (`CROSS JOIN`)

```sql
SELECT s.name AS student, g.name AS graduate
FROM students s
CROSS JOIN graduates g;
```

### üìå –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:

–°–æ–∑–¥–∞—ë—Ç **–¥–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ**: –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –∏–∑ `students` —Å–æ—á–µ—Ç–∞–µ—Ç—Å—è —Å –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–æ–π –∏–∑ `graduates`.

–†–µ–∑—É–ª—å—Ç–∞—Ç (3 —Å—Ç—É–¥–µ–Ω—Ç–∞ √ó 2 –≤—ã–ø—É—Å–∫–Ω–∏–∫–∞ = 6 —Å—Ç—Ä–æ–∫):

```
student | graduate
--------+----------
–ò–≤–∞–Ω    | –ú–∞—Ä–∏—è
–ò–≤–∞–Ω    | –°–µ—Ä–≥–µ–π
–ú–∞—Ä–∏—è   | –ú–∞—Ä–∏—è
–ú–∞—Ä–∏—è   | –°–µ—Ä–≥–µ–π
–ü–µ—Ç—Ä    | –ú–∞—Ä–∏—è
–ü–µ—Ç—Ä    | –°–µ—Ä–≥–µ–π
```

---

## üß† –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| –ó–∞–¥–∞–Ω–∏–µ | –û–ø–µ—Ä–∞—Ç–æ—Ä                 | –¢–∏–ø –∑–∞–¥–∞—á–∏                    |
| ------- | ------------------------ | ----------------------------- |
| 1       | `INTERSECT`/`INNER JOIN` | –ù–∞–π—Ç–∏ –æ–±—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è          |
| 2       | `EXCEPT`                 | –ù–∞–π—Ç–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ |
| 3       | `LEFT JOIN` + `IS NULL`  | –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å ¬´–∏—Å–∫–ª—é—á–µ–Ω–∏—è¬ª       |
| 4       | `CROSS JOIN`             | –í—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏      |

---

