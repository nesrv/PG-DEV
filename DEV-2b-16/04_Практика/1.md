# Практика-1

1. Создайте таблицу с полем типа `bytea`. Загрузите в таблицу любой файл, этот же файл загрузите как большой объект. Выполните контрольную точку, чтобы в кеше не осталось грязных буферов.

2. Добавьте один произвольный байт к значению в столбце типа `bytea` таблицы. Сколько грязных буферов, относящихся к TOAST-таблице, появилось в буферном кеше?

3. Добавьте один произвольный байт к значению большого объекта. Сколько грязных буферов, относящихся к таблице `pg_largeobject`, появилось в буферном кеше?

2 и 3. Чтобы получить количество грязных буферов для таблицы, установите расширение `pg_buffercache` и воспользуйтесь запросом:

```sql
SELECT count(*)
FROM pg_buffercache b
WHERE b.relfilenode = pg_relation_filenode('table_name'::regclass)
  AND b.relforknumber = 0 -- основной слой
  AND isdirty;
````

3. Можно воспользоваться функцией `lo_put`, записывающей данные по заданному смещению.

