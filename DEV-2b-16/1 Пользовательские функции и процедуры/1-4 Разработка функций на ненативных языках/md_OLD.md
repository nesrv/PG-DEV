

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π –Ω–∞ **–Ω–µ–Ω–∞—Ç–∏–≤–Ω—ã—Ö —è–∑—ã–∫–∞—Ö** –≤ PostgreSQL 

(—Ç–æ –µ—Å—Ç—å –Ω–µ –Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö SQL –∏–ª–∏ PL/pgSQL) ‚Äî —ç—Ç–æ –º–æ—â–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ **–Ω–µ–Ω–∞—Ç–∏–≤–Ω—ã—Ö —è–∑—ã–∫–æ–≤** –≤ PostgreSQL, —Ç–∞–∫–∏—Ö –∫–∞–∫ Python, Perl, Tcl, Java, R –∏ –¥—Ä.

---

## üîß 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —è–∑—ã–∫–æ–≤ –≤ PostgreSQL

–ù–µ–Ω–∞—Ç–∏–≤–Ω—ã–µ —è–∑—ã–∫–∏ –Ω–µ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ PostgreSQL ¬´–∏–∑ –∫–æ—Ä–æ–±–∫–∏¬ª. –ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, `plpython3u`, `plperl` –∏ –¥—Ä., –∏—Ö –Ω—É–∂–Ω–æ:

* **–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ**:

  ```sql
  CREATE EXTENSION plpython3u;
  ```

  –î–ª—è –¥—Ä—É–≥–∏—Ö:

  ```sql
  CREATE EXTENSION plperl;
  CREATE EXTENSION pltcl;
  ```

* **–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —è–∑—ã–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Å–±–æ—Ä–∫–æ–π PostgreSQL** (–Ω–∞–ø—Ä–∏–º–µ—Ä, PostgreSQL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–±—Ä–∞–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Python, Perl –∏ —Ç.–¥.). –í —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞—Ö, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —ç—Ç–∏—Ö —è–∑—ã–∫–æ–≤ –µ—Å—Ç—å, –Ω–æ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä:

  * `postgresql-plpython3`
  * `postgresql-plperl`
  * `postgresql-pltcl`

---

## üîê 2. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —è–∑—ã–∫ `u`

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –Ω–µ–Ω–∞—Ç–∏–≤–Ω—ã—Ö —è–∑—ã–∫–æ–≤ –∏–¥—É—Ç —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º `u` ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, `plpython3u`. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç:

* `u` = *untrusted* (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π).
* –¢–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ **–º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∫–æ–¥** –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.
* –¢–æ–ª—å–∫–æ **—Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏.

---

## üß† 3. –ü—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ PL/Python

```sql
CREATE EXTENSION IF NOT EXISTS plpython3u;

CREATE FUNCTION get_os_info()
RETURNS TEXT AS $$
  import platform
  return platform.platform()
$$ LANGUAGE plpython3u;
```

---

## üß† 4. –ü—Ä–∏–º–µ—Ä –Ω–∞ PL/Perl

```sql
CREATE EXTENSION IF NOT EXISTS plperl;

CREATE FUNCTION greet(name TEXT)
RETURNS TEXT AS $$
  return "Hello, $name!";
$$ LANGUAGE plperl;
```

---

## üîÑ 5. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å SQL

–í—Å–µ –Ω–µ–Ω–∞—Ç–∏–≤–Ω—ã–µ —è–∑—ã–∫–∏ –º–æ–≥—É—Ç:

* –ü—Ä–∏–Ω–∏–º–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã PostgreSQL-—Ç–∏–ø–∞ (INTEGER, TEXT, JSON –∏ –¥—Ä.).
* –í–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è.
* –ò–Ω–æ–≥–¥–∞ ‚Äî –≤—ã–∑—ã–≤–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `spi` –≤ PL/Python, PL/Perl –∏ —Ç.–¥.).

### –ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞ SQL –∏–∑ PL/Python:

```sql
CREATE FUNCTION get_table_count(tbl TEXT)
RETURNS INT AS $$
  plan = plpy.prepare("SELECT count(*) FROM " + tbl, [])
  result = plpy.execute(plan)
  return result[0]["count"]
$$ LANGUAGE plpython3u;
```

> ‚ö†Ô∏è –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ SQL —Ç—Ä–µ–±—É–µ—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏ (SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏!).

---

## üß© 6. –î—Ä—É–≥–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (—á–µ—Ä–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –º–æ–¥—É–ª–∏)

* **PL/Java** ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ Java.
* **PL/V8** ‚Äî JavaScript –Ω–∞ –±–∞–∑–µ Google V8.
* **PL/R** ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —è–∑—ã–∫ R.
* –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —ç—Ç–∏—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.

---

## üì¶ –í—ã–≤–æ–¥

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –Ω–µ–Ω–∞—Ç–∏–≤–Ω—ã—Ö —è–∑—ã–∫–∞—Ö –≤ PostgreSQL:

* –î–∞—ë—Ç –º–æ—â–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (–∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö, ML, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º –ü–û).
* –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
* –ß–∞—Å—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* –•–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏, –∫–æ—Ç–æ—Ä—É—é —Ç—Ä—É–¥–Ω–æ –≤—ã—Ä–∞–∑–∏—Ç—å –≤ SQL –∏–ª–∏ PL/pgSQL.

