
**SCD (Slowly Changing Dimension)** ‚Äî —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è **–∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ –∏–∑–º–µ—Ä–µ–Ω–∏—è—Ö** (dimension tables) —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º. –û–Ω–∞ –Ω—É–∂–Ω–∞ –¥–ª—è **—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π** –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ BI-—Å–∏—Å—Ç–µ–º–∞—Ö –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏.

---

## üîç –ó–∞—á–µ–º –Ω—É–∂–Ω–æ SCD?

–ò–∑–º–µ—Ä–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ö–ª–∏–µ–Ω—Ç", "–¢–æ–≤–∞—Ä", "–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ") –º–æ–≥—É—Ç **–º–µ–Ω—è—Ç—å—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º**:

* –ö–ª–∏–µ–Ω—Ç —Å–º–µ–Ω–∏–ª —Ñ–∞–º–∏–ª–∏—é
* –¢–æ–≤–∞—Ä –∏–∑–º–µ–Ω–∏–ª –±—Ä–µ–Ω–¥
* –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –ø–µ—Ä–µ–≤–µ–ª—Å—è –≤ –¥—Ä—É–≥–æ–π –æ—Ç–¥–µ–ª

–ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∑–∞–ø–∏—Å–∏, **–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç—ã —Ç–µ—Ä—è—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç**. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–∫–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç –∫—É–ø–∏–ª –¥–æ —Å–º–µ–Ω—ã —Ñ–∞–º–∏–ª–∏–∏? SCD –ø–æ–∑–≤–æ–ª—è–µ—Ç **—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞ –º–æ–º–µ–Ω—Ç —Å–æ–±—ã—Ç–∏—è**.

---

## üìÇ –í–∏–¥—ã SCD

### üü¢ **SCD Type 1** ‚Äî –ë–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏

* –°—Ç–∞—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è**.
* –ò—Å—Ç–æ—Ä–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.

**–ü—Ä–∏–º–µ—Ä:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ email-–∞–¥—Ä–µ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞.

```sql
UPDATE dim_customer
SET email = 'new@example.com'
WHERE customer_id = 123;
```

üìå **–ü–ª—é—Å—ã**: –ü—Ä–æ—Å—Ç–æ, –º–µ–Ω—å—à–µ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
üìå **–ú–∏–Ω—É—Å—ã**: –ü–æ—Ç–µ—Ä—è –∏—Å—Ç–æ—Ä–∏–∏

---

### üü° **SCD Type 2** ‚Äî –° –∏—Å—Ç–æ—Ä–∏–µ–π (–≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)

* –ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ ‚Äî –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞.
* –î–æ–±–∞–≤–ª—è—é—Ç—Å—è –ø–æ–ª—è: `effective_date`, `expiry_date`, `is_current`

**–ü—Ä–∏–º–µ—Ä:**

```sql
-- –°—Ç–∞—Ä—É—é –∑–∞–ø–∏—Å—å –∑–∞–∫—Ä—ã–≤–∞–µ–º
UPDATE dim_customer
SET expiry_date = '2025-05-23', is_current = FALSE
WHERE customer_id = 123 AND is_current = TRUE;

-- –ù–æ–≤—É—é –≤—Å—Ç–∞–≤–ª—è–µ–º
INSERT INTO dim_customer (customer_id, name, email, effective_date, expiry_date, is_current)
VALUES (123, '–ò–≤–∞–Ω–æ–≤', 'new@example.com', '2025-05-23', NULL, TRUE);
```

üìå **–ü–ª—é—Å—ã**: –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è
üìå **–ú–∏–Ω—É—Å—ã**: –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

---

### üü† **SCD Type 3** ‚Äî –° —á–∞—Å—Ç–∏—á–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π

* –ò—Å—Ç–æ—Ä–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ **–ø–æ –æ–¥–Ω–æ–º—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—è–º**.
* –ù–∞–ø—Ä–∏–º–µ—Ä: `current_region`, `previous_region`

üìå **–ü–ª—é—Å—ã**: –ü—Ä–æ—Å—Ç–æ, –Ω–æ —Å –∏—Å—Ç–æ—Ä–∏–µ–π
üìå **–ú–∏–Ω—É—Å—ã**: –•—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ "–≤–µ—Ä—Å–∏—è –Ω–∞–∑–∞–¥"

---

### üîµ –î—Ä—É–≥–∏–µ —Ç–∏–ø—ã (—Ä–µ–¥–∫–∏–µ, –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)

* **Type 4**: –í—ã–Ω–µ—Å–µ–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
* **Type 6**: –ì–∏–±—Ä–∏–¥ Type 1 + 2 + 3
* **Type 0**: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç–∞—Ç—É—Å—ã –Ω–∞ –º–æ–º–µ–Ω—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)

---

## ‚úÖ –ö–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

| –¢–∏–ø    | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –µ—Å–ª–∏‚Ä¶                                          |
| ------ | ------------------------------------------------------------ |
| Type 1 | –ù–µ –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é, –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã            |
| Type 2 | –ù—É–∂–Ω–∞ –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π                          |
| Type 3 | –ù—É–∂–Ω–∞ —á–∞—Å—Ç–∏—á–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–¥–æ/–ø–æ—Å–ª–µ" –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è) |

---

–ø—Ä–∏–º–µ—Ä —Å—Ö–µ–º—ã —Ç–∞–±–ª–∏—Ü—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π SCD Type 2


–í–æ—Ç –ø—Ä–∏–º–µ—Ä —Å—Ö–µ–º—ã —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π **SCD Type 2** ‚Äî **–ø–æ–ª–Ω–æ–≥–æ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**, —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–æ –≤—Ä–µ–º–µ–Ω–∏.

---

## üîß –ü—Ä–∏–º–µ—Ä: –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å SCD Type 2

```sql
CREATE TABLE dim_customer (
    surrogate_key      SERIAL PRIMARY KEY,       -- –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–ª—é—á (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—Å–∏–∏)
    customer_id        INT NOT NULL,             -- –ë–∏–∑–Ω–µ—Å-–∫–ª—é—á (–æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –¥–ª—è –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π –∫–ª–∏–µ–Ω—Ç–∞)
    full_name          TEXT NOT NULL,
    email              TEXT,
    region             TEXT,
    
    effective_date     DATE NOT NULL,            -- –î–∞—Ç–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ —Å–∏–ª—É
    expiry_date        DATE,                     -- –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è (NULL = —Ç–µ–∫—É—â–∞—è –∑–∞–ø–∏—Å—å)
    is_current         BOOLEAN NOT NULL DEFAULT TRUE,  -- –§–ª–∞–≥ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø–∏—Å–∏
    
    UNIQUE (customer_id, effective_date)         -- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ –±–∏–∑–Ω–µ—Å-–∫–ª—é—á—É –∏ –¥–∞—Ç–µ
);
```

---

### üß† –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:

* –ö–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ –º–µ–Ω—è–µ—Ç—Å—è:

  1. –¢–µ–∫—É—â–∞—è –∑–∞–ø–∏—Å—å **–∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è** (`expiry_date`, `is_current = FALSE`)
  2. –í—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è **–Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞** —Å `effective_date = —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞`, `is_current = TRUE`

---

### üì¶ –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:

| surrogate\_key | customer\_id | full\_name | region | effective\_date | expiry\_date | is\_current |
| -------------- | ------------ | ---------- | ------ | --------------- | ------------ | ----------- |
| 1              | 123          | –ò–≤–∞–Ω–æ–≤     | –ú–æ—Å–∫–≤–∞ | 2024-01-01      | 2024-12-31   | FALSE       |
| 2              | 123          | –ò–≤–∞–Ω–æ–≤     | –ö–∞–∑–∞–Ω—å | 2025-01-01      | NULL         | TRUE        |

---

## üìå –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

* –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å, **–∫–æ–≥–¥–∞ –∏ –∫–∞–∫ –º–µ–Ω—è–ª–∏—Å—å –∑–Ω–∞—á–µ–Ω–∏—è**.
* –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å—Ä–µ–∑–∞–º.

---

–•–æ—á–µ—à—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é —Å—Ö–µ–º—É –¥–ª—è —Ç–æ–≤–∞—Ä–∞, —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏?



