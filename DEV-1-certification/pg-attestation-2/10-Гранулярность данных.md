–û—Ç–ª–∏—á–Ω–∞—è —Ç–µ–º–∞! –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º, —á—Ç–æ —Ç–∞–∫–æ–µ **–≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** –∏ –ø–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ.

---

## üîç –ß—Ç–æ —Ç–∞–∫–æ–µ **–≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å (granularity)** –¥–∞–Ω–Ω—ã—Ö?

**–ì—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å** ‚Äî —ç—Ç–æ **—É—Ä–æ–≤–µ–Ω—å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö** –≤ —Ç–∞–±–ª–∏—Ü–µ —Ñ–∞–∫—Ç–æ–≤ (Fact table).

* –ß–µ–º **–≤—ã—à–µ –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å** ‚Äî —Ç–µ–º –¥–∞–Ω–Ω—ã–µ **–¥–µ—Ç–∞–ª—å–Ω–µ–µ**, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø—Ä–æ–¥–∞–∂–µ.
* –ß–µ–º **–Ω–∏–∂–µ –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å** ‚Äî —Ç–µ–º –¥–∞–Ω–Ω—ã–µ **–æ–±–æ–±—â—ë–Ω–Ω–µ–µ**, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—É–º–º–∞—Ä–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –∑–∞ –¥–µ–Ω—å –∏–ª–∏ –º–µ—Å—è—Ü.

---

## üìè –ü—Ä–∏–º–µ—Ä—ã –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç–∏

| –£—Ä–æ–≤–µ–Ω—å –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç–∏              | –ü—Ä–∏–º–µ—Ä –≤ Sell\_Out                                       |
| ---------------------------------- | -------------------------------------------------------- |
| –í—ã—Å–æ–∫–∞—è (–Ω–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –∞–≥—Ä–µ–≥–∞—Ü–∏–∏) | –ö–∞–∂–¥–∞—è –æ—Ç–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞ (–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ = –æ–¥–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è) |
| –°—Ä–µ–¥–Ω—è—è                            | –ü—Ä–æ–¥–∞–∂–∏ –ø–æ –º–∞–≥–∞–∑–∏–Ω—É –∑–∞ –¥–µ–Ω—å                              |
| –ù–∏–∑–∫–∞—è (–≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –∞–≥—Ä–µ–≥–∞—Ü–∏–∏) | –°—É–º–º–∞—Ä–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –ø–æ —Ä–µ–≥–∏–æ–Ω—É –∑–∞ –º–µ—Å—è—Ü                    |

---

## ‚ö† –ü–æ—á–µ–º—É –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–∞?

* **–î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –¥–∞—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≥–∏–±–∫–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –¥–µ–ª–∞—Ç—å drill-down (—É–≥–ª—É–±–ª–µ–Ω–∏–µ –≤ –¥–µ—Ç–∞–ª–∏).
* **–û–±–æ–±—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** —Ö—Ä–∞–Ω—è—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ, –º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã, –Ω–æ –º–µ–Ω—å—à–µ –≥–∏–±–∫–æ—Å—Ç–∏.
* –ì—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ **–º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö** –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å.

---

## üß© –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å?

* –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á –∏ –æ–±—ä—ë–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö.
* –û–±—ã—á–Ω–æ –±–µ—Ä—É—Ç **–º–∏–Ω–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏**, —á—Ç–æ–±—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –±—ã–ª–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ—á–Ω–æ–π.
* –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ç—ã (summary tables) —Å –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ–π –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å—é –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤.

---

## –ü—Ä–∏–º–µ—Ä

| SaleID | SaleDate   | StoreID | ProductID | Quantity | TotalAmount |
| ------ | ---------- | ------- | --------- | -------- | ----------- |
| 1001   | 2025-05-01 | 10      | 500       | 3        | 285.00      |
| 1002   | 2025-05-01 | 11      | 501       | 1        | 150.00      |

* –ì—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å ‚Äî **–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ = –æ–¥–Ω–∞ –ø—Ä–æ–¥–∞–∂–∞**
* –ï—Å–ª–∏ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É, –≥–¥–µ —Å—Ç—Ä–æ–∫–∏ ‚Äî —Å—É–º–º–∞—Ä–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º –∑–∞ –¥–µ–Ω—å, —Ç–æ –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å —Å–Ω–∏–∑–∏—Ç—Å—è.


—Å–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤–∏–º –≤ —Ç–∞–±–ª–∏—Ü—É `Sell_Out` —Å—Ç–æ–ª–±–µ—Ü `CCD` (Consistent Change Data), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é –≤—Å–µ—Ö **–Ω–µ-–º–µ—Ä–Ω—ã—Ö** —Å—Ç–æ–ª–±—Ü–æ–≤ —á–µ—Ä–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å `#~#`.

---

## 1. –û–ø—Ä–µ–¥–µ–ª—è–µ–º **–º–µ—Ä—ã** (–∏—Ö –Ω–µ –≤–∫–ª—é—á–∞–µ–º –≤ CCD):

* `Quantity`
* `Price`
* `Discount`
* `TotalAmount`

---

## 2. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã ‚Äî –≤–∫–ª—é—á–∞–µ–º –≤ `CCD`.

–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É —Ç–µ–±—è —Ç–∞–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

\| SaleID | SaleDate | StoreID | StoreRegion | ProductID | ProductName | ProductCategory | CustomerID | Gender | Quantity | Price | Discount | TotalAmount |

–¢–æ–≥–¥–∞ –≤ CCD –≤–æ–π–¥—É—Ç:
`SaleID`, `SaleDate`, `StoreID`, `StoreRegion`, `ProductID`, `ProductName`, `ProductCategory`, `CustomerID`, `Gender`

---

## 3. SQL –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è / –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ CCD —Å –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–µ–π

```sql
ALTER TABLE Sell_Out ADD COLUMN CCD TEXT;

UPDATE Sell_Out
SET CCD = 
    COALESCE(CAST(SaleID AS TEXT), '') || '#~#' ||
    COALESCE(CAST(SaleDate AS TEXT), '') || '#~#' ||
    COALESCE(CAST(StoreID AS TEXT), '') || '#~#' ||
    COALESCE(StoreRegion, '') || '#~#' ||
    COALESCE(CAST(ProductID AS TEXT), '') || '#~#' ||
    COALESCE(ProductName, '') || '#~#' ||
    COALESCE(ProductCategory, '') || '#~#' ||
    COALESCE(CAST(CustomerID AS TEXT), '') || '#~#' ||
    COALESCE(Gender, '');
```

---

## 4. –ö–∞–∫ –ø–æ–Ω—è—Ç—å –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –≤ `Sell_Out`?

**–ì—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å** ‚Äî —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Å—Ç–æ–ª–±—Ü–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫—É (—Ñ–∞–∫—Ç).

–î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ –∫–∞–∫–∏–º —Å—Ç–æ–ª–±—Ü–∞–º –¥–∞–Ω–Ω—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã.

---

### SQL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏:

```sql
SELECT COUNT(*) AS total_rows,
       COUNT(DISTINCT CCD) AS distinct_ccd,
       COUNT(DISTINCT SaleID) AS distinct_saleid
FROM Sell_Out;
```

* –ï—Å–ª–∏ `COUNT(*) = COUNT(DISTINCT CCD)`, –∑–Ω–∞—á–∏—Ç –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–∞ –ø–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–ª–µ–π ‚Äî –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ç—Ä–æ–∫–∏.
* –ï—Å–ª–∏ `SaleID` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, —Ç–æ –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å ‚Äî –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–¥–∞–∂.

---

### –ò–ª–∏ –ø—Ä–æ—â–µ ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:

```sql
SELECT COUNT(*) AS total_rows,
       COUNT(DISTINCT SaleID) AS distinct_saleid
FROM Sell_Out;
```

* –ï—Å–ª–∏ `total_rows = distinct_saleid` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ SaleID (–≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å = –æ–¥–Ω–∞ –ø—Ä–æ–¥–∞–∂–∞).

---

## –ò—Ç–æ–≥:

* `CCD` ‚Äî —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞ —Å –∫–ª—é—á–µ–≤—ã–º–∏ (–Ω–µ-–º–µ—Ä–Ω—ã–º–∏) –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –¥–ª—è –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ñ–∞–∫—Ç–∞.
* –ì—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å ‚Äî –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ `CCD` —É–Ω–∏–∫–∞–ª–µ–Ω.

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –º–æ–≥—É –ø–æ–º–æ—á—å —Å –Ω–∞–ø–∏—Å–∞–Ω–∏–µ–º –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏–ª–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º CCD –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –¥–∞–Ω–Ω—ã—Ö.
