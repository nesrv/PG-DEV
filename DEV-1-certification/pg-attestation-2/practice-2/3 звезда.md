## ⭐ Звезда:


* В центре — **фактовая таблица** (все числовые данные: продажи, суммы, количество и т.п.).
* Вокруг — **измерения** (таблицы-справочники: что, кто, где, когда и т.д.).


### Шаг 1: Найди **факт**

Фактовая таблица — это **центр звезды**, таблица, где хранятся **измеримые данные**:

```text
Sold QTY, Purchase price
```

И все ключи, по которым мы можем привязать справочники (кто, что, когда, где, кому).

### Фактовая таблица — `sales`:

```text
sale_id, partner_id, sold_date, sale_city_code, reference_code, sold_qty, purchase_price, inn_client
```

---

### Шаг 2: Выдели **измерения** (справочники)

Теперь все **нечисловые повторяющиеся данные** выносим в отдельные таблицы:

#### 📘 1. `partners` — поставщики

```text
partner_id, partner_name
```

#### 📘 2. `clients` — клиенты

```text
inn_client, client_name, client_city_code, client_category
```

#### 📘 3. `products` — товары

```text
reference_code
```

#### 📘 4. `cities` — города

```text
city_code, city_name
```

> Используется и для `sale_city_code`, и для `client_city_code`.

---

### Шаг 3: Свяжи таблицы

Факт `sales` будет ссылаться на измерения:

| Поле в `sales`     | Ссылается на таблицу | Поле в таблице                |
| ------------------ | -------------------- | ----------------------------- |
| `partner_id`       | `partners`           | `partner_id`                  |
| `reference_code`   | `products`           | `reference_code`              |
| `inn_client`       | `clients`            | `inn_client`                  |
| `sale_city_code`   | `cities`             | `city_code`                   |
| `client_city_code` | `cities`             | `city_code` (через `clients`) |

---

### 🖼 Получившаяся звезда

Центр: `sales`
Измерения: `partners`, `clients`, `products`, `cities`

Так можно отвечать на вопросы вроде:

* Сколько продано по каждому городу?
* Кто купил больше всего?
* Какие товары чаще всего покупают клиенты из Москвы?
* Какая общая сумма продаж по партнёру?

---

## 💡 Запомни

| Факт           | Измерение                             |
| -------------- | ------------------------------------- |
| Продажи, суммы | Поставщик                             |
| Кол-во, цена   | Клиент                                |
|                | Город                                 |
|                | Товар                                 |
|                | Дата (если нужно — отдельная таблица) |

---

Если хочешь, могу показать:

* SQL-код создания таблиц;
* Как это реализовать в Excel или SQLite;
* Или нарисовать полный пример с запросами.




* **Фактовая таблица** содержит числовые данные, которые агрегируются (например, `sold_qty`, `purchase_price`).
* **Измерения (dimensions)** — справочные таблицы, описывающие "что", "где", "кому", "кто".

---

## ✅ Структура "звезды"

```
                     ┌────────────┐
                     │  cities    │◄────────────┐
                     └────────────┘             │
                           ▲                    │
                           │                    │
 ┌────────────┐     ┌────────────┐       ┌──────────────┐
 │  partners  │◄────│   sales    │──────►│   products   │
 └────────────┘     └────────────┘       └──────────────┘
                           ▲                
                           │                
                    ┌────────────┐          
                    │  clients   │          
                    └────────────┘
                           ▲
                           │
                    ┌────────────┐
                    │  cities    │ (повторно)
                    └────────────┘
```

---

## 🧩 Описание таблиц

### 📌 `sales` — **Факт**

Содержит количественные показатели продаж:

```text
sale_id, partner_id, sold_date, sale_city_code, reference_code, sold_qty, purchase_price, inn_client
```

---

### 📌 `partners` — **Измерение (Кто продал)**

```text
partner_id, partner_name
```

---

### 📌 `clients` — **Измерение (Кому продали)**

```text
inn_client, client_name, client_city_code, client_category
```

---

### 📌 `products` — **Измерение (Что продали)**

```text
reference_code
```

---

### 📌 `cities` — **Измерение (Где продали / Где клиент)**

```text
city_code, city_name
```

> Используется дважды: для поля `sale_city_code` в `sales` и `client_city_code` в `clients`.

---

## 🧠 Пример аналитических запросов (что можно считать)

* 📊 Общий объём продаж по категориям клиентов
* 🏙️ Продажи по городам
* 📅 Динамика продаж по датам
* 💰 Средняя цена закупки по товарам
* 👤 Рейтинг партнёров по продажам

---
